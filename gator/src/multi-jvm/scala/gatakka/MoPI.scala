package gatakka

import util.Random

/**
 * Just a quick way to get some sentences
 * for profiling during testing.
 */
object MoPI {
  val naieveSplit = "\\w*[.?!](?=\\s)"
  def randomSentence = Random.nextInt(mopiallSentences.size)
  val mopiallSentences: Array[String] =
    """
      |She was standing in the middle of a circle of people in an open meadow. Earthlike. With fourteen trillion people running around Cyberspace, you'd think a few of them would come up with something more imaginative than carbon copies of the Earth. Poor quality carbon copies at that, natch. There was a big hole in the ground, perhaps ten feet wide, at her feet.
      |A tall, youthfully handsome man stood across it from her, impeccably dressed and groomed. This was a bad sign, because appearances were cheap in Cyberspace. All it took was a word, and you could be young or old or thin or have different hair. You could change sex or race or even make yourself into an animal. Nobody was impressed by appearances any more. Nobody, at least, except for those of her generation who remembered what it was to be insecure, and the very young who hadn't figured out the score yet.
      |Caroline let her own body age naturally; when she reached her apparent late thirties, she had it restored to about age sixteen. This wasn't vanity; she couldn't maintain her athletic lifestyle if she allowed herself to get too old. She had been through the cycle dozens of times. Most people simply had themselves frozen at an age they found comfortable and left it at that, but Caroline preferred the occasional dramatic intervention. The first time she had regressed she hadn't been asked, and doing it this way helped remind her of that violation.
      |At the moment Caroline looked to be in her mid to late twenties. Her athletic build was the result of real exercise, her skills the result of real practice. She asked Prime Intellect for very little, and resented having to ask for that.
      |Caroline was naked. She had not worn clothes since the Change except for an occasional costume in a Death fantasy. She wore no makeup, and her long hair was an unkempt tangle. What was the point? A word to Prime Intellect could provide anything, fix anything, but none of those things it provided or fixed would be uniquely hers.
      |Which didn't mean Caroline refused to decorate her body at all. It just meant that she decorated it in signature style, without help from Prime Intellect.
      |"Welcome," he said. "I am Timothy. You are Caroline Hubert?"
      |"The one and only."
      |"An honor, then. And it is an honor for me to challenge you to accept Authentic Death."
      |"Proceed," Caroline mumbled.
      |Caroline looked around at the audience, and noticed that they were all wearing clothes. Worse, they were all wearing the same kind of clothes, casual dress that would not have been out of place in a Western city just before the Change. That was an even stronger sign she was in amateur territory. Caroline's aesceticism may have been extreme, but she was hardly alone in her belief that clothing was pointless for immortals. Any random grouping of people would normally include some pretty wide variations in fashion. Especially at Death exhibitions, which tended to attract loons and deviants like herself.
      |She felt an instant dislike for this kid. True, she felt an instant dislike for nearly anybody who participated in the sham that passed for reality in Cyberspace, but in Timothy's case the feeling was stronger than usual. This hate welled up within her unbidden like those other mysterious and powerful feelings, love and masochism and sexual attraction. He had a kind of natural charisma, and she could feel the small crowd orbiting around him. Females outnumbered the males by more than two to one. He probably had them all convinced he was a fucking genius, as if genius was a rare commodity in Cyberspace or as if it had anything to do.
      |They were anxious, though. Anxious in the presence of the great lady, anxious to see how their little tin genius would fare. They were unnerved by her nakedness, by her proud and alert stance, by her forthrightness and lack of self-consciousness. They sensed that their clothing could not protect them from her scorn, nor would her nakedness make her vulnerable to theirs.
      |Most of all, though, they were unnerved by the fact that she wasn't quite naked.
      |Caroline's body was covered with brightly colored pictures, pictures that had obviously been there a long time. Pictures that didn't come off. The pictures were even worse than simple nakedness, because they drew the eye to the very parts of Caroline's body that would normally be covered and private. Timothy coughed and posed the question that was obviously on all of their minds: "Your body decorations are fascinating. Are they Authentic?"
      |"Tattoos."
      |"I understand the process is painful."
      |She flexed her arm, regarding the fat python coiled around it. Painful? Especially the way she got them, it was painful. She was covered in serpents, and with one exception every design had been drawn with an obsidian knife blade and colored by rubbing natural pigments into the cuts. They covered eighty percent of her body. Even her face was framed by a pair of green mambas. Snakes slithered up and down her torso, coiled about her limbs, investigated her orifices.
      |The one exception was a tiny black design on her left shin; that one wasn't a snake and it wasn't a tattoo. It was the letter "F" and it was the signature of her tattoo artist. It had been applied with a branding iron. The memories made her smile; new tattoos were the only good thing about her periodic age regressions.
      |"It doesn't kill you," she finally said.
      |Nervous laughter.
      |"All you have to do is jump in," Timothy suggested. "After making the Contract, of course."
      |"It's a designed experience, is that it?"
      |"Yes."
      |"How long you spent designing it?"
      |"Two years. I've gone through twenty-three times myself."
      |Caroline nodded, sighed, and said: "Prime Intellect, standard Death Contract for...is twelve hours enough?"
      |"It should be," Timothy said.
      |"Standard Contract for twelve hours." She felt the warning buzz that meant it had heard; then disconnect. The always-present listening ear, or microphone, was gone. It would obey her last command perfectly -- until it was countermanded by Timothy, whose universe it was, or by her own impending demise, which would kick in the First Law. Or until twelve hours had passed, in the unlikely event she survived that long.
      |No matter what happened, she would have no trouble making Raven's party.
      |She jumped.
      |
      |She fell about ten meters and landed on her feet, breaking her left leg below the knee. That was no big deal; had she landed on one of the spikes which dotted the bottom of the hole, she'd already be impaled. She wondered what would happen next if she had; impaling is cute but it hardly qualifies as a grade-nine experience.
      |It was dark. Very Freudian; she should have expected that from a Catholic kid, no matter how rebellious he thought he was. They'd be watching her with enhanced senses, though. Timothy wasn't the sort to extend Authenticity to the observation process.
      |Well, it was his universe.
      |She was at one end of a tunnel. It was dolled up to look like a natural cave, but Caroline knew right away that there was nothing natural about it. Real caves do not grow in nice neat lines. They twist. They tend to follow the soft rocks, which occur in sheets and often aren't level. The hole she had fallen through should have been a sinkhole; she should be surrounded by fallen rocks and debris. But it was as straight and solid as an elevator shaft.
      |This space had none of the defining qualities of a natural cave. It was just a rough tunnel, carved by Timothy's imagination. He had thought to hang stalactites from the tunnel ceiling, even though there were no other cave formations to suggest how they were formed, and no matching stalagmites projecting from the flat, dry floor.
      |She began crawling down the tunnel, and the first stalactite fell inches from her side. It shattered; it was not stone but some glasslike material that revealed thousands of razor-sharp edges. Another fell some distance away. Great, she thought idly. She crawled on, collecting hundreds of small cuts from the shards. Then one fell on her left hand directly, skewering it. Caroline gasped, but she didn't scream. She just broke it off and kept going.
      |She wondered if he was aiming them, or if the fall was random. It didn't really matter; the idea wasn't to survive, after all.
      |She reached the end of the tunnel, and found herself in a small chamber. Another tunnel veered off to the right at a sharp angle. How imaginative. A glowing ball hung by a thread from the ceiling. She raised her hand toward the light and watched in astonishment as her fingers sheared off in a perfect line.
      |"Whafuck?" she said aloud. She moved her hand again, and sliced off more flesh. An invisible cutting surface was stretched across the room. The pain was beginning to get interesting, but not interesting enough to counteract her growing sense of boredom. Blood was jetting from the stumps of her fingers. Summoning her strength, she aimed carefully and sat up, deliberately decapitating herself.
      |She was conscious of her own head falling, striking the floor as her body twitched above, and then Prime Intellect intervened.
      |"Why the hell did you do that?" Timothy demanded from across the entry pit. She had snapped back whole, as if she had never jumped. She could still feel a little pain where her leg had broken, just a fading echo. Fading fast.
      |"If you had designed it right, I wouldn't have been able to do that. What the hell was that cutter supposed to be, anyway?"
      |"That was diamond monofilament. Part of the booby trap you were supposed to get past, minus a few more dents. If you..."
      |"You call that Authentic?"
      |"It's physically possible..."
      |"No it's not. This is science-fiction shit. What were those stalactites made of? I can tell you it wasn't calcium carbonate. Look, you want to compete in Pain, or Adventure, or Imagination, go right ahead. But Authentic is for things that could really have happened in the pre-Change world."
      |"I don't think you understand..."
      |"I don't think you understand, sonny. Did you bother to ask Prime Intellect about me?"
      |"You're pre-Change and you're the best. That's what counts."
      |"Not just pre-Change. I was a hundred and six years old. Before the Change. I was in a nursing home with bedsores the size of baseballs and six different kinds of cancer eating me away. And my nurse was stealing my pain medication to trade for cocaine, so I got to experience every delightful moment in full three-D. This went on for years. And I didn't know Prime Intellect was gonna pop me back into this nice healthy body when it was all over. It was just the inky unknown and the pain. That's what death is. That's what counts."
      |"I was just trying to reach an artistic balance," he pouted. "I didn't realize you'd be so picky about the technical details."
      |"Artistic? What fucking bullshit! You think I've never been chopped into little bitty bits before? You just don't have time to appreciate art in a situation like that. Not if you have any human feelings at all."
      |"Why not? It's just a game."
      |"That is exactly the problem." She signalled Prime Intellect, and the meadow disappeared.
      |
      |"You really put him in his place."
      |The words came from a shambling monster, a skeleton with loose folds of rotting flesh draped across its bones. Although its muscles couldn't possibly work, it moved, pointing a bony finger at her. The jaw moved as it talked, and sound came out even though the larynx and lungs had long rotted away. Its voice was strong and powerful. Surprisingly bright and alert eyes bobbed in the eye sockets.
      |"You're starting to stink, Fred."
      |"I know. I think it adds an extra dimension to the experience. You wouldn't believe how many types of bacteria are involved in the decay process."
      |Fred was on his seventh body as a zombie; when all the scraps of flesh rotted away and he was reduced to a living skeleton, he'd have it fleshed out again and start the process over. He had directed Prime Intellect to change the rules slightly in his personal space; death was still impossible, but healing occurred only in the authentic circumstances at the authentic rate. When healing was impossible, as it was after each time Fred cut his wrists to extinguish the life of his new body, consciousness and feeling would go on. Even for a rotting corpse.
      |It had started out as nothing more than a little joke on Caroline's periodic un-aging ritual, but Fred had found that it was fun to be a zombie.
      |His personal home was decorated in a matching Halloween motif; he had a huge haunted house with rotting floorboards and real ghosts. Large spiders spun intricate webs in the corners. Monsters prowled outside in the graveyard.
      |"That punk needed his bubble popped. He should spend some time as a zombie. Might teach him something."
      |"He never will. Too vain."
      |"Never is a long time," he reminded her.
      |There was a dramatic ding, followed several seconds later by a long, sonorous dong. A kid's voice: "Trick or treat!"
      |"Care to get the door, darling?" Fred asked graciously.
      |Caroline laughed and got up. Fred faded away. She knew the "kid" would be nearly as old as herself. Prime Intellect would never allow a real child anywhere near Fred. But Caroline wasn't the only one to appreciate his twisted and darkly humorous fantasies.
      |She opened the door and juvenile eyes opened wide in startled amazement. "Lady, you're naked!" the brat said. He looked about twelve, and was a surprisingly good actor. It was easy to believe his dumbfounded gape was the reaction of a pubescent boy who had never seen a naked woman before.
      |"No I'm not," Caroline said sweetly. I have my beautiful tattoos."
      |"I...I..."
      |"You want a treat?" Caroline asked teasingly, cupping her breasts and offering them to him. Her left nipple was already being tasted by a tattooed snake, whose body was coiled around her right breast, framing it invitingly.
      |"My...my mama said..."
      |"Or you want the trick?" Fred floated down from the roof and wrapped one rotting hand around the kid's head, forcing him forward, mashing his face against her bosom. "Take a close look," he said. "Take your last look."
      |The kid began screeching quite realistically, then Fred dragged him inside and started taking him apart. He should have gone into shock after Fred ripped off his right arm, but that little physiological mechanism also didn't work in Fred's home. Fred took a couple of experimental bites, then tossed the arm aside.
      |"Stringy," Fred said. "Let's try a drumstick."
      |The screams reached ear-piercing levels as Fred ripped off the left leg. There was blood everywhere, but Fred was working fast and the kid wouldn't have time to bleed to death.
      |"Want a bite?" he asked Caroline.
      |"Thanks, I already ate," Caroline said politely.
      |Fred the Zombie ripped the boy's belly open and rooted in his intestines, then gutted him. Finally he administered what should have been the coup de grace by ripping the kid's head off.
      |Fred held it up by the hair and pressed the face against Caroline's breasts. "One last kiss," he directed. The eyes were still tracking, and the mouth trying to scream. Then it kissed her left nipple, touching its blue tongue to the forked tongue of the tattoo-snake as Fred had directed it to.
      |"Bye now," he said to the head, and he dropped it and smashed it underfoot.
      |"Do these guys really get off on this?" Caroline asked.
      |"This question coming from a woman who infected herself with rabies, no less." The body, including the spreading stain of blood and gore, disappeared. "Nearly all of them are pre-Change. You saw an example of a modern sex pervert just before your arrival here."
      |"Ugh. Give me Charlie Manson. Someone with class."
      |"At your service."
      |Debate had raged just after the Change over people like Fred, the serial killers and pedophiles and rapists that were running around when things got made over. There was a huge demand for them to be eliminated, or punished. Prime Intellect had stood its ground, saying that it was no longer possible for them to hurt anyone and there wasn't any point. This had made it seem terribly moral, although Caroline thought the real reason Prime Intellect reacted that way was that Lawrence had fucked up its programming. But it had been a little late to do anything about that.
      |"You didn't pop over to check out the guilt-ridden pedophiles," Fred said. "You want to play?"
      |She shrugged. "Beats farting around with Timothy." She steeled herself. "Standard Contract until the party," she then said to the thin air. There was no need to tell Prime Intellect what kind of Contract she meant. She played with Fred often enough that it knew exactly what she wanted. She felt the buzz, then the disconnect, as it cut off contact.
      |"Now I have you," Fred said.
      |"First you have to catch me," Caroline said playfully, and she ran. She made it out the front door before Fred could react. But she was limited to ordinary human movements, while Fred had the controls to local reality. He simply flew after her and caught her neck in an iron grip.
      |Caroline swung at him but she couldn't connect. He held her at arm's length, slightly off the ground. She gripped his arm and tried to pry his bony fingers from her throat. He tightened his grip and she started to gasp. Tightened some more, and she began to tremble and turn purple. He played with her for a few minutes, choking her very slowly. Finally she had no more strength to fight and he loosened his grip slightly. Then he dragged her back to the house and carried her upstairs to the master bedroom.
      |She flickered in and out of consciousness; when lucidity finally returned, she was spread-eagled on her back on Fred's bed. It stank of Fred and mildew, and things crawled beneath her in the mattress. But rotten as they appeared, the four massive posts were solid within, and the chains which held her were cold and unforgiving. A thin trickle of water ran down the wall behind her.
      |For a brief moment she felt an irrational but wholly understandable surge of love for Fred. His life might read like a catalogue of torture, but there were certain things which he considered special, that he would not share with just anybody. His most cherished memories from the real times before the Change were of victims securely bound as Caroline was now bound, spread-eagled on their backs, their young bodies stretched and their naked bellies vulnerable as he prepared a long, memorable ending for their otherwise meaningless lives. Caroline was one of the few he trusted to be worthy of those memories, to share in the (to him) beautiful thing he had created so many hundreds of years ago, when it was still possible. It was as close to a declaration of true love as she could ever expect to get from such a psychopath. And because she respected Fred more than anyone else in Cyberspace, it made her feel appreciated and special.
      |It did not make her feel warm. She was, after all, helpless, and being worthy of Fred's affection meant she would be worthy of a long, subtle, and agonizing torture. Even though she had asked for it, she had room to fear what was about to happen to her.
      |It was always cool in Fred's house -- always Halloween, which occurs at nighttime in the autumn. But now it was chilly, too chilly to be naked. Fred the Zombie came for her, and she allowed herself a scream to please him.
      |His rotting fingers probed her cunt. Every touch set her on fire, partly (but not entirely) because he was using his power to control her hormones and tickle her neurotransmitters, forcing her to become sexually excited. It was a delicate process that could easily be carried too far, ruining the effect. But Fred was a very careful, if repulsive, lover.
      |He grinned at her -- could do nothing else, really, since hardly anything was left of his face except the skull itself. His alert eyes savored her helplessness. He leaned over the bed, over her. He gripped her head and kissed her, nearly choking her with his stink, teeth and bone against her lips. Then she felt herself gripping the finger in her cunt, gripping the bone. The throbbing spread through her body, and the shambling thing emitted an evil laugh. She heard herself screaming as the carefuly amplified orgasm ripped through her brain.
      |Fred traced the outline of her throat with the sharp tip of a finger bone. "Join me love," he said softly. Caroline was still shaking from the force of her orgasm when she felt the adrenaline being pumped into her system. Pleasure yielded to fear-heart-racing, paralyzing terror. Her muscles locked in struggle against the implacable chains, her eyes widened in helpless shock. Her heart was a jackhammer inside of her chest. She began to hyperventilate.
      |The finger teased her, tracing her chin and caressing her throat.
      |Her entire being was focused on that finger, and the impossibility of stopping it.
      |Caroline had no reason to fear death and no desire to fear Fred, but fear was what he wanted her to feel, and he had the power to make her feel it. After a few minutes of this supernatural fear that no mortal thankfully could ever know, he pressed deeper and gouged. She felt her throat open, felt the warm splash of her own blood as Fred bent over her and drank it, her own heart jetting it into his toothy waiting mouth.
      |When he finished, he was covered with blood. Her blood. She felt a curious sense of detachment, of consciousness fading away. The fear had drained from her, leaving her with only a kind of tingling numbness. But she could never fade completely away, not in Fred's world.
      |She was covered with her own blood. She felt the blood soaking the mattress. Then there was an improbable hardness against her belly, huge and unimaginably cold. Fred couldn't possibly have anything to violate her with. His whole body was rotten. But he slid into position, and invaded her.
      |He was coldness and power. All strength had left her and she lay passive, unable to move or protest. But she was throbbing, her body surging with feelings. She felt the coldness spread out from her crotch, the coldness of second life. The coldness brought back her strength.
      |It wasn't exactly the traditional vampire story, but it was good for a few hours' entertainment.
      |After the coldness came the hunger. Fred pumped something into her that couldn't have possibly been sperm, something searing and vicious. Something that squirmed with unhealthy life. She again found the strength to struggle, and Fred floated off of her, straight up. He began to laugh. At first he just chuckled, then he laughed loud and long and hard, a shrill cry of triumph and mockery as he hovered in the air over her body.
      |A haze of need seemed to fill her brain. Prime Intellect was a bit picky about messing with peoples' brains, but Fred had spent years practicing his manipulation of hormones and chemical neurotransmitters, which Prime Intellect amazingly did not consider part of the "thought process." Caroline thrashed, still helpless in Fred's chains, with an unspeakable craving. Fred had started with the symptoms of heroin addiction, amplified them, cross-connected the resulting feelings with her sex drive, and made her own spilled blood the only thing that could appease the resulting hunger-lust. The smell of her blood threatened to drive her insane with its tantalizing promise of relief. But even though the whole room seemed to be decorated with it, every precious drop was out of reach, and the feelings burned inside her.
      |Fred's emission was also still inside her, and she could feel it. Growing. Crawling. The adrenaline rush returned. Fear and need consumed her, competing for control. Something green began to seep from inside her. Her belly distended. Fred touched her and made her orgasm again, and again, and again, as her body was consumed from the inside and the hunger ate at her sanity.
      |She was no longer screaming just to please Fred.
      |He had real talent. There were too few people like him, who could regularly make her feel something beyond the ordinary boredom of day-to-day existence. Out of trillions, Caroline could count those she respected enough to think of as lovers on her fingers.
      |It was over too soon. With flesh yet on her bones (though the worms in Fred's ejaculate had made good headway), he granted her one final burst of ecstasy and released her, returning her body to normal.
      |They had a party to attend.
    """.stripMargin.split(naieveSplit).filter(_.trim.size > 0)
}
